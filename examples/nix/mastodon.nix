# mastodon â€” generated by onix. Do not edit.
{ pkgs ? import <nixpkgs> {}, ruby ? pkgs.ruby_3_4 }:
let
  buildGem = import ./build-gem.nix { inherit pkgs ruby; };
  buildGemByName = name:
    let
      versions = import (./ruby + "/${name}.nix");
      version = builtins.head (builtins.attrNames versions);
      spec = versions.${version};
    in buildGem (spec // { gemName = name; });
  gemConfig = import ./gem-config.nix {
    inherit pkgs ruby;
    overlayDir = ../overlays/ruby;
    rubyDir = ./ruby;
    buildGemFn = buildGemByName;
  };

  build = name: version:
    let
      versions = import (./ruby + "/${name}.nix");
      spec = versions.${version};
      config = gemConfig.${name} or {};
    in buildGem (spec // {
      gemName = name;
      nativeBuildInputs = config.deps or [];
      extconfFlags = config.extconfFlags or "";
      preBuild = config.preBuild or "";
      postBuild = config.postBuild or "";
    } // (if config ? buildPhase then { inherit (config) buildPhase; } else {})
      // (if config ? postInstall then { inherit (config) postInstall; } else {})
      // (if config ? skip then { inherit (config) skip; } else {})
      // (if config ? buildGems then { inherit (config) buildGems; } else {}));

  gems = {
    actioncable = build "actioncable" "8.0.3";
    actionmailbox = build "actionmailbox" "8.0.3";
    actionmailer = build "actionmailer" "8.0.3";
    actionpack = build "actionpack" "8.0.3";
    actiontext = build "actiontext" "8.0.3";
    actionview = build "actionview" "8.0.3";
    active_model_serializers = build "active_model_serializers" "0.10.16";
    activejob = build "activejob" "8.0.3";
    activemodel = build "activemodel" "8.0.3";
    activerecord = build "activerecord" "8.0.3";
    activestorage = build "activestorage" "8.0.3";
    activesupport = build "activesupport" "8.0.3";
    addressable = build "addressable" "2.8.8";
    aes_key_wrap = build "aes_key_wrap" "1.1.0";
    android_key_attestation = build "android_key_attestation" "0.3.0";
    annotaterb = build "annotaterb" "4.21.0";
    ast = build "ast" "2.4.3";
    attr_required = build "attr_required" "1.0.2";
    "aws-eventstream" = build "aws-eventstream" "1.4.0";
    "aws-partitions" = build "aws-partitions" "1.1213.0";
    "aws-sdk-core" = build "aws-sdk-core" "3.242.0";
    "aws-sdk-kms" = build "aws-sdk-kms" "1.121.0";
    "aws-sdk-s3" = build "aws-sdk-s3" "1.213.0";
    "aws-sigv4" = build "aws-sigv4" "1.12.1";
    "azure-blob" = build "azure-blob" "0.5.9.1";
    base64 = build "base64" "0.3.0";
    bcp47_spec = build "bcp47_spec" "0.2.1";
    bcrypt = build "bcrypt" "3.1.21";
    better_errors = build "better_errors" "2.10.1";
    bigdecimal = build "bigdecimal" "3.3.1";
    bindata = build "bindata" "2.5.1";
    binding_of_caller = build "binding_of_caller" "1.0.1";
    blurhash = build "blurhash" "0.1.8";
    bootsnap = build "bootsnap" "1.22.0";
    brakeman = build "brakeman" "8.0.2";
    browser = build "browser" "6.2.0";
    builder = build "builder" "3.3.0";
    "bundler-audit" = build "bundler-audit" "0.9.3";
    capybara = build "capybara" "3.40.0";
    "capybara-playwright-driver" = build "capybara-playwright-driver" "0.5.7";
    case_transform = build "case_transform" "0.2";
    cbor = build "cbor" "0.5.10.1";
    charlock_holmes = build "charlock_holmes" "0.7.9";
    chewy = build "chewy" "7.6.0";
    childprocess = build "childprocess" "5.1.0";
    chunky_png = build "chunky_png" "1.4.0";
    climate_control = build "climate_control" "1.2.0";
    cocoon = build "cocoon" "1.2.15";
    color_diff = build "color_diff" "0.2";
    "concurrent-ruby" = build "concurrent-ruby" "1.3.6";
    connection_pool = build "connection_pool" "2.5.5";
    cose = build "cose" "1.3.1";
    crack = build "crack" "1.0.1";
    crass = build "crass" "1.0.6";
    css_parser = build "css_parser" "1.21.1";
    csv = build "csv" "3.3.5";
    "database_cleaner-active_record" = build "database_cleaner-active_record" "2.2.2";
    "database_cleaner-core" = build "database_cleaner-core" "2.0.1";
    debug = build "debug" "1.11.1";
    debug_inspector = build "debug_inspector" "1.2.0";
    devise = build "devise" "5.0.0";
    "devise-two-factor" = build "devise-two-factor" "6.4.0";
    devise_pam_authenticatable2 = build "devise_pam_authenticatable2" "9.2.0";
    "diff-lcs" = build "diff-lcs" "1.6.2";
    discard = build "discard" "1.4.0";
    docile = build "docile" "1.4.1";
    domain_name = build "domain_name" "0.6.20240107";
    doorkeeper = build "doorkeeper" "5.8.2";
    dotenv = build "dotenv" "3.2.0";
    drb = build "drb" "2.2.3";
    "dry-cli" = build "dry-cli" "1.4.1";
    elasticsearch = build "elasticsearch" "7.17.11";
    "elasticsearch-api" = build "elasticsearch-api" "7.17.11";
    "elasticsearch-dsl" = build "elasticsearch-dsl" "0.1.10";
    "elasticsearch-transport" = build "elasticsearch-transport" "7.17.11";
    email_spec = build "email_spec" "2.3.0";
    email_validator = build "email_validator" "2.2.4";
    erubi = build "erubi" "1.13.1";
    "et-orbi" = build "et-orbi" "1.4.0";
    excon = build "excon" "1.3.2";
    fabrication = build "fabrication" "3.0.0";
    faker = build "faker" "3.6.0";
    faraday = build "faraday" "2.14.1";
    "faraday-follow_redirects" = build "faraday-follow_redirects" "0.5.0";
    "faraday-httpclient" = build "faraday-httpclient" "2.0.2";
    "faraday-net_http" = build "faraday-net_http" "3.4.2";
    fast_blank = build "fast_blank" "1.0.1";
    fastimage = build "fastimage" "2.4.0";
    ffi = build "ffi" "1.17.3";
    "ffi-compiler" = build "ffi-compiler" "1.3.2";
    flatware = build "flatware" "2.3.4";
    "flatware-rspec" = build "flatware-rspec" "2.3.4";
    "fog-core" = build "fog-core" "2.6.0";
    "fog-json" = build "fog-json" "1.2.0";
    "fog-openstack" = build "fog-openstack" "1.1.5";
    formatador = build "formatador" "1.2.3";
    fugit = build "fugit" "1.12.1";
    globalid = build "globalid" "1.3.0";
    "google-protobuf" = build "google-protobuf" "4.33.5";
    "googleapis-common-protos-types" = build "googleapis-common-protos-types" "1.22.0";
    haml = build "haml" "7.2.0";
    "haml-rails" = build "haml-rails" "3.0.0";
    haml_lint = build "haml_lint" "0.69.0";
    hashdiff = build "hashdiff" "1.2.1";
    hashie = build "hashie" "5.1.0";
    hcaptcha = build "hcaptcha" "7.1.0";
    highline = build "highline" "3.1.2";
    hiredis = build "hiredis" "0.6.3";
    "hiredis-client" = build "hiredis-client" "0.26.4";
    hkdf = build "hkdf" "0.3.0";
    htmlentities = build "htmlentities" "4.3.4";
    http = build "http" "5.3.1";
    "http-cookie" = build "http-cookie" "1.1.0";
    "http-form_data" = build "http-form_data" "2.3.0";
    http_accept_language = build "http_accept_language" "2.1.1";
    httpclient = build "httpclient" "2.9.0";
    httplog = build "httplog" "1.8.0";
    i18n = build "i18n" "1.14.8";
    "i18n-tasks" = build "i18n-tasks" "1.1.2";
    "idn-ruby" = build "idn-ruby" "0.1.5";
    inline_svg = build "inline_svg" "1.10.0";
    "jd-paperclip-azure" = build "jd-paperclip-azure" "3.0.0";
    jmespath = build "jmespath" "1.6.2";
    "json-canonicalization" = build "json-canonicalization" "1.0.0";
    "json-jwt" = build "json-jwt" "1.17.0";
    "json-ld" = build "json-ld" "3.3.2";
    "json-ld-preloaded" = build "json-ld-preloaded" "3.3.2";
    "json-schema" = build "json-schema" "6.1.0";
    "jsonapi-renderer" = build "jsonapi-renderer" "0.2.2";
    jwt = build "jwt" "2.10.2";
    kaminari = build "kaminari" "1.2.2";
    "kaminari-actionview" = build "kaminari-actionview" "1.2.2";
    "kaminari-activerecord" = build "kaminari-activerecord" "1.2.2";
    "kaminari-core" = build "kaminari-core" "1.2.2";
    "kt-paperclip" = build "kt-paperclip" "7.3.0";
    "language_server-protocol" = build "language_server-protocol" "3.17.0.5";
    launchy = build "launchy" "3.1.1";
    letter_opener = build "letter_opener" "1.10.0";
    letter_opener_web = build "letter_opener_web" "3.0.0";
    link_header = build "link_header" "0.0.8";
    lint_roller = build "lint_roller" "1.1.0";
    linzer = build "linzer" "0.7.7";
    "llhttp-ffi" = build "llhttp-ffi" "0.5.1";
    lograge = build "lograge" "0.14.0";
    loofah = build "loofah" "2.25.0";
    mail = build "mail" "2.9.0";
    marcel = build "marcel" "1.0.4";
    "mario-redis-lock" = build "mario-redis-lock" "1.2.1";
    matrix = build "matrix" "0.4.3";
    memory_profiler = build "memory_profiler" "1.1.0";
    "mime-types" = build "mime-types" "3.7.0";
    "mime-types-data" = build "mime-types-data" "3.2026.0203";
    mini_mime = build "mini_mime" "1.1.5";
    mini_portile2 = build "mini_portile2" "2.8.9";
    minitest = build "minitest" "6.0.1";
    msgpack = build "msgpack" "1.8.0";
    multi_json = build "multi_json" "1.19.1";
    mutex_m = build "mutex_m" "0.3.0";
    "net-imap" = build "net-imap" "0.6.2";
    "net-ldap" = build "net-ldap" "0.20.0";
    "net-pop" = build "net-pop" "0.1.2";
    "net-smtp" = build "net-smtp" "0.5.1";
    nio4r = build "nio4r" "2.7.5";
    nokogiri = build "nokogiri" "1.19.0";
    oj = build "oj" "3.16.15";
    omniauth = build "omniauth" "2.1.4";
    "omniauth-cas" = build "omniauth-cas" "3.0.2";
    "omniauth-rails_csrf_protection" = build "omniauth-rails_csrf_protection" "2.0.1";
    "omniauth-saml" = build "omniauth-saml" "2.2.4";
    omniauth_openid_connect = build "omniauth_openid_connect" "0.8.0";
    openid_connect = build "openid_connect" "2.3.1";
    "openssl-signature_algorithm" = build "openssl-signature_algorithm" "1.3.0";
    "opentelemetry-api" = build "opentelemetry-api" "1.7.0";
    "opentelemetry-common" = build "opentelemetry-common" "0.23.0";
    "opentelemetry-exporter-otlp" = build "opentelemetry-exporter-otlp" "0.31.1";
    "opentelemetry-helpers-sql" = build "opentelemetry-helpers-sql" "0.3.0";
    "opentelemetry-helpers-sql-processor" = build "opentelemetry-helpers-sql-processor" "0.4.0";
    "opentelemetry-instrumentation-action_mailer" = build "opentelemetry-instrumentation-action_mailer" "0.6.1";
    "opentelemetry-instrumentation-action_pack" = build "opentelemetry-instrumentation-action_pack" "0.15.1";
    "opentelemetry-instrumentation-action_view" = build "opentelemetry-instrumentation-action_view" "0.11.2";
    "opentelemetry-instrumentation-active_job" = build "opentelemetry-instrumentation-active_job" "0.10.1";
    "opentelemetry-instrumentation-active_model_serializers" = build "opentelemetry-instrumentation-active_model_serializers" "0.24.0";
    "opentelemetry-instrumentation-active_record" = build "opentelemetry-instrumentation-active_record" "0.11.1";
    "opentelemetry-instrumentation-active_storage" = build "opentelemetry-instrumentation-active_storage" "0.3.1";
    "opentelemetry-instrumentation-active_support" = build "opentelemetry-instrumentation-active_support" "0.10.1";
    "opentelemetry-instrumentation-base" = build "opentelemetry-instrumentation-base" "0.25.0";
    "opentelemetry-instrumentation-concurrent_ruby" = build "opentelemetry-instrumentation-concurrent_ruby" "0.24.0";
    "opentelemetry-instrumentation-excon" = build "opentelemetry-instrumentation-excon" "0.27.0";
    "opentelemetry-instrumentation-faraday" = build "opentelemetry-instrumentation-faraday" "0.31.0";
    "opentelemetry-instrumentation-http" = build "opentelemetry-instrumentation-http" "0.28.0";
    "opentelemetry-instrumentation-http_client" = build "opentelemetry-instrumentation-http_client" "0.27.0";
    "opentelemetry-instrumentation-net_http" = build "opentelemetry-instrumentation-net_http" "0.27.0";
    "opentelemetry-instrumentation-pg" = build "opentelemetry-instrumentation-pg" "0.35.0";
    "opentelemetry-instrumentation-rack" = build "opentelemetry-instrumentation-rack" "0.29.0";
    "opentelemetry-instrumentation-rails" = build "opentelemetry-instrumentation-rails" "0.39.1";
    "opentelemetry-instrumentation-redis" = build "opentelemetry-instrumentation-redis" "0.28.0";
    "opentelemetry-instrumentation-sidekiq" = build "opentelemetry-instrumentation-sidekiq" "0.28.1";
    "opentelemetry-registry" = build "opentelemetry-registry" "0.4.0";
    "opentelemetry-sdk" = build "opentelemetry-sdk" "1.10.0";
    "opentelemetry-semantic_conventions" = build "opentelemetry-semantic_conventions" "1.36.0";
    orm_adapter = build "orm_adapter" "0.5.0";
    ox = build "ox" "2.14.23";
    parallel = build "parallel" "1.27.0";
    parser = build "parser" "3.3.10.1";
    parslet = build "parslet" "2.0.0";
    pastel = build "pastel" "0.8.0";
    pg = build "pg" "1.6.3";
    pghero = build "pghero" "3.7.0";
    "playwright-ruby-client" = build "playwright-ruby-client" "1.57.1";
    premailer = build "premailer" "1.27.0";
    "premailer-rails" = build "premailer-rails" "1.12.0";
    prometheus_exporter = build "prometheus_exporter" "2.3.1";
    propshaft = build "propshaft" "1.3.1";
    public_suffix = build "public_suffix" "7.0.2";
    puma = build "puma" "7.2.0";
    pundit = build "pundit" "2.5.2";
    raabro = build "raabro" "1.4.0";
    racc = build "racc" "1.8.1";
    rack = build "rack" "3.2.4";
    "rack-attack" = build "rack-attack" "6.8.0";
    "rack-cors" = build "rack-cors" "3.0.0";
    "rack-oauth2" = build "rack-oauth2" "2.3.0";
    "rack-protection" = build "rack-protection" "4.2.1";
    "rack-proxy" = build "rack-proxy" "0.7.7";
    "rack-session" = build "rack-session" "2.1.1";
    "rack-test" = build "rack-test" "2.2.0";
    rackup = build "rackup" "2.3.1";
    rails = build "rails" "8.0.3";
    "rails-dom-testing" = build "rails-dom-testing" "2.3.0";
    "rails-html-sanitizer" = build "rails-html-sanitizer" "1.6.2";
    "rails-i18n" = build "rails-i18n" "8.1.0";
    railties = build "railties" "8.0.3";
    rainbow = build "rainbow" "3.1.1";
    rake = build "rake" "13.3.1";
    rdf = build "rdf" "3.3.4";
    "rdf-normalize" = build "rdf-normalize" "0.7.0";
    redcarpet = build "redcarpet" "3.6.1";
    redis = build "redis" "4.8.1";
    "redis-client" = build "redis-client" "0.26.4";
    regexp_parser = build "regexp_parser" "2.11.3";
    request_store = build "request_store" "1.7.0";
    responders = build "responders" "3.2.0";
    rexml = build "rexml" "3.4.4";
    rotp = build "rotp" "6.3.0";
    rouge = build "rouge" "4.7.0";
    rpam2 = build "rpam2" "4.0.2";
    rqrcode = build "rqrcode" "3.2.0";
    rqrcode_core = build "rqrcode_core" "2.1.0";
    rspec = build "rspec" "3.13.2";
    "rspec-core" = build "rspec-core" "3.13.6";
    "rspec-expectations" = build "rspec-expectations" "3.13.5";
    "rspec-github" = build "rspec-github" "3.0.0";
    "rspec-mocks" = build "rspec-mocks" "3.13.7";
    "rspec-rails" = build "rspec-rails" "8.0.2";
    "rspec-sidekiq" = build "rspec-sidekiq" "5.2.0";
    "rspec-support" = build "rspec-support" "3.13.7";
    rubocop = build "rubocop" "1.84.0";
    "rubocop-ast" = build "rubocop-ast" "1.49.0";
    "rubocop-capybara" = build "rubocop-capybara" "2.22.1";
    "rubocop-i18n" = build "rubocop-i18n" "3.2.3";
    "rubocop-performance" = build "rubocop-performance" "1.26.1";
    "rubocop-rails" = build "rubocop-rails" "2.34.3";
    "rubocop-rspec" = build "rubocop-rspec" "3.9.0";
    "rubocop-rspec_rails" = build "rubocop-rspec_rails" "2.32.0";
    "ruby-prof" = build "ruby-prof" "1.7.2";
    "ruby-progressbar" = build "ruby-progressbar" "1.13.0";
    "ruby-saml" = build "ruby-saml" "1.18.1";
    "ruby-vips" = build "ruby-vips" "2.3.0";
    rubyzip = build "rubyzip" "3.2.2";
    "rufus-scheduler" = build "rufus-scheduler" "3.9.2";
    safety_net_attestation = build "safety_net_attestation" "0.5.0";
    sanitize = build "sanitize" "7.0.0";
    scenic = build "scenic" "1.9.0";
    "shoulda-matchers" = build "shoulda-matchers" "7.0.1";
    sidekiq = build "sidekiq" "8.0.10";
    "sidekiq-bulk" = build "sidekiq-bulk" "0.2.0";
    "sidekiq-scheduler" = build "sidekiq-scheduler" "6.0.1";
    "sidekiq-unique-jobs" = build "sidekiq-unique-jobs" "8.0.13";
    "simple-navigation" = build "simple-navigation" "4.4.1";
    simple_form = build "simple_form" "5.4.1";
    simplecov = build "simplecov" "0.22.0";
    "simplecov-html" = build "simplecov-html" "0.13.2";
    "simplecov-lcov" = build "simplecov-lcov" "0.9.0";
    simplecov_json_formatter = build "simplecov_json_formatter" "0.1.4";
    stackprof = build "stackprof" "0.2.27";
    starry = build "starry" "0.2.0";
    stoplight = build "stoplight" "5.7.0";
    strong_migrations = build "strong_migrations" "2.5.2";
    swd = build "swd" "2.0.3";
    sysexits = build "sysexits" "1.2.0";
    temple = build "temple" "0.10.4";
    "terminal-table" = build "terminal-table" "4.0.0";
    terrapin = build "terrapin" "1.1.1";
    "test-prof" = build "test-prof" "1.5.2";
    thor = build "thor" "1.5.0";
    tilt = build "tilt" "2.7.0";
    "tpm-key_attestation" = build "tpm-key_attestation" "0.14.1";
    "tty-color" = build "tty-color" "0.6.0";
    "tty-cursor" = build "tty-cursor" "0.7.1";
    "tty-prompt" = build "tty-prompt" "0.23.1";
    "tty-reader" = build "tty-reader" "0.9.0";
    "tty-screen" = build "tty-screen" "0.8.2";
    "twitter-text" = build "twitter-text" "3.1.0";
    tzinfo = build "tzinfo" "2.0.6";
    "tzinfo-data" = build "tzinfo-data" "1.2025.3";
    unf = build "unf" "0.1.4";
    unf_ext = build "unf_ext" "0.0.9.1";
    "unicode-display_width" = build "unicode-display_width" "3.2.0";
    "unicode-emoji" = build "unicode-emoji" "4.2.0";
    useragent = build "useragent" "0.16.11";
    validate_url = build "validate_url" "1.0.15";
    vite_rails = build "vite_rails" "3.0.20";
    vite_ruby = build "vite_ruby" "3.9.2";
    warden = build "warden" "1.2.9";
    webauthn = build "webauthn" "3.4.3";
    webfinger = build "webfinger" "2.1.3";
    webmock = build "webmock" "3.26.1";
    webpush = build "webpush" "1.1.0";
    webrick = build "webrick" "1.9.2";
    "websocket-driver" = build "websocket-driver" "0.8.0";
    "websocket-extensions" = build "websocket-extensions" "0.1.5";
    wisper = build "wisper" "2.0.1";
    xorcist = build "xorcist" "1.1.3";
    xpath = build "xpath" "3.2.0";
    zeitwerk = build "zeitwerk" "2.7.4";
  };

  bundlePath = pkgs.buildEnv {
    name = "mastodon-bundle";
    paths = builtins.attrValues gems;
  };
in gems // {
  inherit bundlePath;
  devShell = { buildInputs ? [], shellHook ? "", ... }@args:
    pkgs.mkShell (builtins.removeAttrs args ["buildInputs" "shellHook"] // {
      name = "mastodon-devshell";
      buildInputs = [ ruby ] ++ buildInputs;
      shellHook = ''
        export BUNDLE_PATH="${bundlePath}"
        export BUNDLE_GEMFILE="''${BUNDLE_GEMFILE:-$PWD/Gemfile}"
        export GEM_PATH="${bundlePath}/${ruby.gemPath}''${GEM_PATH:+:$GEM_PATH}"
      '' + shellHook;
    });
}
