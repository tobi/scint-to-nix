# vite â€” generated by onix. Do not edit.
{ pkgs ? import <nixpkgs> {}, ruby ? pkgs.ruby_3_4 }:
let
  buildGem = import ./build-gem.nix { inherit pkgs ruby; };
  buildGemByName = name:
    let
      versions = import (./ruby + "/${name}.nix");
      version = builtins.head (builtins.attrNames versions);
      spec = versions.${version};
    in buildGem (spec // { gemName = name; });
  gemConfig = import ./gem-config.nix {
    inherit pkgs ruby;
    overlayDir = ../overlays;
    rubyDir = ./ruby;
    buildGemFn = buildGemByName;
  };
  nodeConfig = import ./node-config.nix {
    inherit pkgs;
    overlayDir = ../overlays/node;
  };

  build = name: version:
    let
      versions = import (./ruby + "/${name}.nix");
      spec = versions.${version};
      config = gemConfig.${name} or {};
    in buildGem (spec // {
      gemName = name;
      nativeBuildInputs = config.deps or [];
      extconfFlags = config.extconfFlags or "";
      preBuild = config.preBuild or "";
      postBuild = config.postBuild or "";
    } // (if config ? buildPhase then { inherit (config) buildPhase; } else {})
      // (if config ? postInstall then { inherit (config) postInstall; } else {})
      // (if config ? skip then { inherit (config) skip; } else {})
      // (if config ? buildGems then { inherit (config) buildGems; } else {}));

  gems = {
  };

  nodePackages = {
    "@eslint/js/9.39.2" = {
      name = "@eslint/js";
      version = "9.39.2";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@type-challenges/utils/0.1.1" = {
      name = "@type-challenges/utils";
      version = "0.1.1";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@types/babel__core/7.20.5" = {
      name = "@types/babel__core";
      version = "7.20.5";
      source = "pnpm";
      deps = [ "@babel/parser" "@babel/types" "@types/babel__generator" "@types/babel__template" "@types/babel__traverse" ];
      groups = [ "development" ];
    };
    "@types/babel__preset-env/7.10.0" = {
      name = "@types/babel__preset-env";
      version = "7.10.0";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@types/convert-source-map/2.0.3" = {
      name = "@types/convert-source-map";
      version = "2.0.3";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@types/cross-spawn/6.0.6" = {
      name = "@types/cross-spawn";
      version = "6.0.6";
      source = "pnpm";
      deps = [ "@types/node" ];
      groups = [ "development" ];
    };
    "@types/estree/1.0.8" = {
      name = "@types/estree";
      version = "1.0.8";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@types/etag/1.8.4" = {
      name = "@types/etag";
      version = "1.8.4";
      source = "pnpm";
      deps = [ "@types/node" ];
      groups = [ "development" ];
    };
    "@types/less/3.0.8" = {
      name = "@types/less";
      version = "3.0.8";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@types/node/22.19.10" = {
      name = "@types/node";
      version = "22.19.10";
      source = "pnpm";
      deps = [ "undici-types" ];
      groups = [ "development" ];
    };
    "@types/picomatch/4.0.2" = {
      name = "@types/picomatch";
      version = "4.0.2";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "@types/stylus/0.48.43" = {
      name = "@types/stylus";
      version = "0.48.43";
      source = "pnpm";
      deps = [ "@types/node" ];
      groups = [ "development" ];
    };
    "@types/ws/8.18.1" = {
      name = "@types/ws";
      version = "8.18.1";
      source = "pnpm";
      deps = [ "@types/node" ];
      groups = [ "development" ];
    };
    "@vitejs/release-scripts/1.6.0(conventional-commits-filter@5.0.0)" = {
      name = "@vitejs/release-scripts";
      version = "1.6.0(conventional-commits-filter@5.0.0)";
      source = "pnpm";
      deps = [ "conventional-changelog" "conventional-changelog-conventionalcommits" "execa" "mri" "picocolors" "prompts" "publint" "semver" ];
      groups = [ "development" ];
    };
    "eslint-plugin-import-x/4.16.1(@typescript-eslint/utils@8.54.0(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(ms@2.1.3)(typescript@5.9.3))(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(ms@2.1.3)" = {
      name = "eslint-plugin-import-x";
      version = "4.16.1(@typescript-eslint/utils@8.54.0(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(ms@2.1.3)(typescript@5.9.3))(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(ms@2.1.3)";
      source = "pnpm";
      deps = [ "@typescript-eslint/types" "comment-parser" "debug" "eslint" "eslint-import-context" "is-glob" "minimatch" "semver" "stable-hash-x" "unrs-resolver" ];
      groups = [ "development" ];
    };
    "eslint-plugin-n/17.23.2(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(typescript@5.9.3)" = {
      name = "eslint-plugin-n";
      version = "17.23.2(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(typescript@5.9.3)";
      source = "pnpm";
      deps = [ "@eslint-community/eslint-utils" "enhanced-resolve" "eslint" "eslint-plugin-es-x" "get-tsconfig" "globals" "globrex" "ignore" "semver" "ts-declaration-location" ];
      groups = [ "development" ];
    };
    "eslint-plugin-regexp/3.0.0(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))" = {
      name = "eslint-plugin-regexp";
      version = "3.0.0(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))";
      source = "pnpm";
      deps = [ "@eslint-community/eslint-utils" "@eslint-community/regexpp" "comment-parser" "eslint" "jsdoc-type-pratt-parser" "refa" "regexp-ast-analysis" "scslre" ];
      groups = [ "development" ];
    };
    "eslint/9.39.2(jiti@2.6.1)(ms@2.1.3)" = {
      name = "eslint";
      version = "9.39.2(jiti@2.6.1)(ms@2.1.3)";
      source = "pnpm";
      deps = [ "@eslint-community/eslint-utils" "@eslint-community/regexpp" "@eslint/config-array" "@eslint/config-helpers" "@eslint/core" "@eslint/eslintrc" "@eslint/js" "@eslint/plugin-kit" "@humanfs/node" "@humanwhocodes/module-importer" "@humanwhocodes/retry" "@types/estree" "ajv" "chalk" "cross-spawn" "debug" "escape-string-regexp" "eslint-scope" "eslint-visitor-keys" "espree" "esquery" "esutils" "fast-deep-equal" "file-entry-cache" "find-up" "glob-parent" "ignore" "imurmurhash" "is-glob" "json-stable-stringify-without-jsonify" "lodash.merge" "minimatch" "natural-compare" "optionator" ];
      groups = [ "development" ];
    };
    "execa/9.6.1" = {
      name = "execa";
      version = "9.6.1";
      source = "pnpm";
      deps = [ "@sindresorhus/merge-streams" "cross-spawn" "figures" "get-stream" "human-signals" "is-plain-obj" "is-stream" "npm-run-path" "pretty-ms" "signal-exit" "strip-final-newline" "yoctocolors" ];
      groups = [ "development" ];
    };
    "globals/17.3.0" = {
      name = "globals";
      version = "17.3.0";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "lint-staged/16.2.7" = {
      name = "lint-staged";
      version = "16.2.7";
      source = "pnpm";
      deps = [ "commander" "listr2" "micromatch" "nano-spawn" "pidtree" "string-argv" "yaml" ];
      groups = [ "development" ];
    };
    "picocolors/1.1.1" = {
      name = "picocolors";
      version = "1.1.1";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "playwright-chromium/1.58.2" = {
      name = "playwright-chromium";
      version = "1.58.2";
      source = "pnpm";
      deps = [ "playwright-core" ];
      groups = [ "development" ];
    };
    "prettier/3.8.1" = {
      name = "prettier";
      version = "3.8.1";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "rolldown/1.0.0-rc.4" = {
      name = "rolldown";
      version = "1.0.0-rc.4";
      source = "pnpm";
      deps = [ "@oxc-project/types" "@rolldown/pluginutils" ];
      groups = [ "development" ];
    };
    "rollup/4.57.1" = {
      name = "rollup";
      version = "4.57.1";
      source = "pnpm";
      deps = [ "@types/estree" ];
      groups = [ "development" ];
    };
    "simple-git-hooks/2.13.1" = {
      name = "simple-git-hooks";
      version = "2.13.1";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "tsx/4.21.0" = {
      name = "tsx";
      version = "4.21.0";
      source = "pnpm";
      deps = [ "esbuild" "get-tsconfig" ];
      groups = [ "development" ];
    };
    "typescript-eslint/8.54.0(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(ms@2.1.3)(typescript@5.9.3)" = {
      name = "typescript-eslint";
      version = "8.54.0(eslint@9.39.2(jiti@2.6.1)(ms@2.1.3))(ms@2.1.3)(typescript@5.9.3)";
      source = "pnpm";
      deps = [ "@typescript-eslint/eslint-plugin" "@typescript-eslint/parser" "@typescript-eslint/typescript-estree" "@typescript-eslint/utils" "eslint" "typescript" ];
      groups = [ "development" ];
    };
    "typescript/5.9.3" = {
      name = "typescript";
      version = "5.9.3";
      source = "pnpm";
      deps = [  ];
      groups = [ "development" ];
    };
    "vite/link:packages/vite" = {
      name = "vite";
      version = "link:packages/vite";
      source = "link";
      deps = [  ];
      groups = [ "development" ];
      path = "packages/vite";
    };
    "vitest/4.0.18(@types/node@22.19.10)" = {
      name = "vitest";
      version = "4.0.18(@types/node@22.19.10)";
      source = "pnpm";
      deps = [ "@vitest/expect" "@vitest/mocker" "@vitest/pretty-format" "@vitest/runner" "@vitest/snapshot" "@vitest/spy" "@vitest/utils" "es-module-lexer" "expect-type" "magic-string" "obug" "pathe" "picomatch" "std-env" "tinybench" "tinyexec" "tinyglobby" "tinyrainbow" "vite" "why-is-node-running" ];
      groups = [ "development" ];
    };
  };

  nodeModules = pkgs.callPackage ./build-node-modules.nix {
    inherit nodePackages;
    inherit nodeConfig;
    project = "vite";
    projectRoot = ../vite/.;
    lockfile = ../vite/pnpm-lock.yaml;
    packageManager = "pnpm@10.29.2";
    scriptPolicy = "allowed";
    pnpmDepsHash = "sha256-qQ8wy5NcZCL++bICwOU5vDDGuJ1amy8oq57sMEFWJ8Y=";
    workspacePaths = [ "packages/vite" ];
  };

  bundlePath = pkgs.buildEnv {
    name = "vite-bundle";
    paths = builtins.attrValues gems;
  };
in gems // {
  inherit bundlePath;
  inherit nodeModules;
  devShell = { buildInputs ? [], shellHook ? "", ... }@args:
    pkgs.mkShell (builtins.removeAttrs args ["buildInputs" "shellHook"] // {
      name = "vite-devshell";
      buildInputs = [ ruby ] ++ buildInputs;
      shellHook = ''
        export BUNDLE_PATH="${bundlePath}"
        export BUNDLE_GEMFILE="''${BUNDLE_GEMFILE:-$PWD/Gemfile}"
        export GEM_PATH="${bundlePath}/${ruby.gemPath}''${GEM_PATH:+:$GEM_PATH}"
      '' + shellHook;
    });
}
